import{_ as i}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as r,c as l,a as e,b as o,d as h,e as n,r as t}from"./app.59944050.js";const d={},c=n('<h1 id="服务注册发现" tabindex="-1"><a class="header-anchor" href="#服务注册发现" aria-hidden="true">#</a> 服务注册发现</h1><h2 id="一、服务注册" tabindex="-1"><a class="header-anchor" href="#一、服务注册" aria-hidden="true">#</a> 一、服务注册</h2><blockquote><p>service B 把自己注册到Service Registry</p></blockquote><h4 id="_1-1-注册中心" tabindex="-1"><a class="header-anchor" href="#_1-1-注册中心" aria-hidden="true">#</a> 1.1 注册中心</h4><h4 id="_1-1-1-实现原理" tabindex="-1"><a class="header-anchor" href="#_1-1-1-实现原理" aria-hidden="true">#</a> 1.1.1 实现原理</h4><blockquote><p>设计思想</p></blockquote><ol><li>服务注册。接受来自服务提交的注册信息，并保存起来</li><li>服务下线。接受服务的主动下线请求，并将服务从注册信息表中删除</li><li>服务获取。调用方从注册中心拉取服务信息</li><li>服务续约。服务健康检查，服务通过心跳保持（主动续约）告知注册中心服务</li><li>服务剔除。注册中心将长时间不续约的服务实例从注册信息表中删除。 <ol><li>保护模式。</li></ol></li></ol><h4 id="_1-2-服务端注册" tabindex="-1"><a class="header-anchor" href="#_1-2-服务端注册" aria-hidden="true">#</a> 1.2 服务端注册</h4><ol><li>启动注册。在服务启动时完成并设置<strong>有效期</strong>，防止程序异常退出</li><li>定时续期。 <ol><li>注册中心主动探活。</li><li>服务实例主动上报。</li></ol></li><li>退出撤销。应主动去撤销注册信息，便于调用方及时将请求分发到别的节点。【<strong>Knuth-Shuffle算法，公平洗牌算法</strong>】 <ol><li>剔除上限数量=当前注册表大小-触发自我保护机制阀值</li></ol></li></ol><h2 id="二、服务发现" tabindex="-1"><a class="header-anchor" href="#二、服务发现" aria-hidden="true">#</a> 二、服务发现</h2><h3 id="_2-1-服务调用方" tabindex="-1"><a class="header-anchor" href="#_2-1-服务调用方" aria-hidden="true">#</a> 2.1 服务调用方</h3><h4 id="_2-1-2-问题点" tabindex="-1"><a class="header-anchor" href="#_2-1-2-问题点" aria-hidden="true">#</a> 2.1.2 问题点</h4><ol><li>存量获取。service A启动，从service registry获取service b的已有节点</li><li>增量监听。新增服务时，通知服务调用方</li><li>应对服务发现故障。在内存里缓存一个可用节点列表</li></ol><h2 id="三、参考资料" tabindex="-1"><a class="header-anchor" href="#三、参考资料" aria-hidden="true">#</a> 三、参考资料</h2>',14),s={href:"https://mp.weixin.qq.com/s/WZ6HG-ZLFiBJLbE29vTr3g",target:"_blank",rel:"noopener noreferrer"};function _(u,f){const a=t("ExternalLinkIcon");return r(),l("div",null,[c,e("ol",null,[e("li",null,[e("a",s,[o("服务注册中心"),h(a)])])])])}const p=i(d,[["render",_],["__file","服务注册发现.html.vue"]]);export{p as default};
