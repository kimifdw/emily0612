import{_ as s}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as a,c as n,e}from"./app.59944050.js";const t={},l=e(`<h1 id="基于tomcat脚本" tabindex="-1"><a class="header-anchor" href="#基于tomcat脚本" aria-hidden="true">#</a> 基于tomcat脚本</h1><h2 id="一、编译" tabindex="-1"><a class="header-anchor" href="#一、编译" aria-hidden="true">#</a> 一、编译</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># build.sh</span>
<span class="token assign-left variable">DATE</span><span class="token operator">=</span><span class="token variable"><span class="token variable">\`</span><span class="token function">date</span> <span class="token string">&quot;+%Y-%m-%d-%H-%M-%S&quot;</span><span class="token variable">\`</span></span>
<span class="token assign-left variable">PROJECT</span><span class="token operator">=</span>xxxx
<span class="token builtin class-name">echo</span> <span class="token string">&quot;----------svn checkout ------------&quot;</span>+<span class="token variable">$DATE</span>
<span class="token builtin class-name">cd</span> <span class="token variable">$svn</span>/<span class="token variable">$PROJECT</span>
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> trunk
<span class="token function">git</span> clone <span class="token parameter variable">-b</span> feature-xxx http://用户名:密码@ip/<span class="token variable">$PROJECT</span>.git trunk
<span class="token builtin class-name">echo</span> <span class="token string">&quot;----------mvn build ------------&quot;</span>
<span class="token builtin class-name">cd</span> ./trunk
mvn clean <span class="token function">install</span> <span class="token parameter variable">-Dmaven.test.skip</span><span class="token operator">=</span>true <span class="token parameter variable">-U</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;----------shut down tomcat------------&quot;</span>
<span class="token builtin class-name">cd</span> <span class="token variable">$tomcat</span>/apache-tomcat-<span class="token variable">$PROJECT</span>/bin
./shutdown.sh
<span class="token assign-left variable">tomcatID</span><span class="token operator">=</span><span class="token variable"><span class="token variable">\`</span><span class="token function">ps</span> <span class="token parameter variable">-ef</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&#39;tomcat&#39;</span>  <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&#39;gam&#39;</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token string">&#39;grep&#39;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">&#39;{print $2}&#39;</span><span class="token variable">\`</span></span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-n</span> <span class="token string">&quot;<span class="token variable">$tomcatID</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
<span class="token builtin class-name">echo</span> <span class="token string">&#39;current tomcat pid is:&#39;</span><span class="token variable">$tomcatID</span>
<span class="token function">kill</span> <span class="token parameter variable">-9</span> <span class="token variable">$tomcatID</span>
<span class="token keyword">else</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;cuurent application  not start&quot;</span>
<span class="token keyword">fi</span>
<span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>/webapps
<span class="token function">cp</span> <span class="token variable">$PROJECT</span>.war <span class="token variable">$PROJECT</span>.war.<span class="token variable">$DATE</span>
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">$PROJECT</span>.war
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> <span class="token variable">$PROJECT</span>
<span class="token function">cp</span> <span class="token variable">$svn</span>/<span class="token variable">$PROJECT</span>/trunk/<span class="token variable">$PROJECT</span>.web/target/<span class="token variable">$PROJECT</span>.war <span class="token variable">$tomcat</span>/apache-tomcat-<span class="token variable">$PROJECT</span>/webapps
<span class="token builtin class-name">cd</span> <span class="token variable">$tomcat</span>/apache-tomcat-<span class="token variable">$PROJECT</span>/bin
<span class="token builtin class-name">echo</span> <span class="token string">&quot;----------startup tomcat------------&quot;</span>
./startup.sh <span class="token operator">&amp;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="二、重启" tabindex="-1"><a class="header-anchor" href="#二、重启" aria-hidden="true">#</a> 二、重启</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># restart.sh</span>
<span class="token assign-left variable">PROG_NAME</span><span class="token operator">=</span>tomcat
<span class="token assign-left variable">PROG_START</span><span class="token operator">=</span>startup.sh
<span class="token assign-left variable">DATE</span><span class="token operator">=</span><span class="token variable"><span class="token variable">\`</span><span class="token function">date</span> <span class="token string">&quot;+%Y-%m-%d-%H-%M-%S&quot;</span><span class="token variable">\`</span></span>
<span class="token assign-left variable">PROJECT</span><span class="token operator">=</span>XXXX
<span class="token assign-left variable">PROG_NAME</span><span class="token operator">=</span>tomcat
<span class="token assign-left variable">PROG_START</span><span class="token operator">=</span>startup
<span class="token builtin class-name">echo</span> <span class="token string">&quot;------------------auto start tomcat-------------&quot;</span>+<span class="token variable">$DATE</span>
<span class="token keyword">while</span> <span class="token boolean">true</span>
 <span class="token keyword">do</span>
 <span class="token builtin class-name">echo</span> <span class="token string">&quot;---------------query tomcatId-------------&quot;</span>
 <span class="token assign-left variable">PROG_NUM</span><span class="token operator">=</span><span class="token variable"><span class="token variable">\`</span><span class="token function">ps</span> <span class="token parameter variable">-ef</span> <span class="token operator">|</span> <span class="token function">grep</span> $PROG_NAME<span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&#39;gam&#39;</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token function">grep</span> <span class="token operator">|</span> <span class="token function">wc</span> <span class="token parameter variable">-l</span><span class="token variable">\`</span></span>
 <span class="token builtin class-name">echo</span> <span class="token string">&quot;------output tomcat----&quot;</span>+<span class="token variable">$PROG_NUM</span>
  <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$PROG_NUM</span> <span class="token parameter variable">-lt</span> <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    /usr/local/XXXX/build.sh 
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;start success&quot;</span>
  <span class="token keyword">fi</span>
  <span class="token function">sleep</span> <span class="token number">5</span>
<span class="token keyword">done</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5),p=[l];function i(c,o){return a(),n("div",null,p)}const v=s(t,[["render",i],["__file","yongxingsec.html.vue"]]);export{v as default};
